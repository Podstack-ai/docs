<!--
  SINGLE PAGE TEMPLATE (layouts/_default/single.html)
  PURPOSE: Renders individual documentation pages
  
  LAYOUT:
  - Header (fixed top): Site navigation and search
  - Sidebar (left): Recursive navigation tree with section expandable/collapsible
  - Main content (center): Page title, content, and prev/next navigation
  - Table of Contents (right): Page heading outline with smooth scroll linking
  - Footer: Site links and social media
  
  FEATURES:
  - Three-column responsive layout
  - Automatic prev/next navigation using page weight
  - Sidebar with unlimited nesting support
  - Table of Contents auto-generated from headings
  - Mobile responsive with off-canvas menu
  - Dark/light theme support
  
  RELATED FILES:
  - partials/sidebar.html: Navigation sidebar
  - partials/header.html: Top navigation bar with search
  - partials/footer.html: Footer section
  - css/docs.css: Main documentation styles
  - js/sidebar.js: Sidebar toggle and navigation
  - js/table-of-contents.js: TOC scroll highlighting
-->
<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode | default `en-US` }}">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="{{ .Page.Params.description | default .Site.Params.description | .RenderString }}">
  <meta name="keywords" content="{{ with .Params.keywords }}{{ delimit . ", " }}{{ else }}{{ .Site.Params.seo.keywords }}{{ end }}">
  <meta name="author" content="{{ .Site.Params.author.name }}">
  {{ with .Params.keywords | default .Site.Params.keywords }}
  <meta name="keywords" content="{{ delimit . ", " }}">
  {{ end }}
  <meta name="theme-color" content="{{ .Site.Params.project.themeColor.light }}" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="{{ .Site.Params.project.themeColor.dark }}" media="(prefers-color-scheme: dark)">
  {{ with .Params.robots -}}
  <meta name="robots" content="{{ . }}">
  {{ else -}}
  <meta name="robots" content="index, follow">
  {{ end -}}

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ .Permalink }}">
  <meta property="og:title" content="{{ .Title }} · {{ .Site.Title }}">
  <meta property="og:description" content="{{ .Page.Params.description | default .Site.Params.description }}">
  <meta property="og:image" content="{{ .Site.Params.seo.ogImage | absURL }}">
  <meta property="og:site_name" content="{{ .Site.Title }}">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="{{ .Permalink }}">
  <meta name="twitter:title" content="{{ .Title }} · {{ .Site.Title }}">
  <meta name="twitter:description" content="{{ .Page.Params.description | default .Site.Params.description }}">
  <meta name="twitter:image" content="{{ .Site.Params.seo.ogImage | absURL }}">

  <title>{{ .Title | .RenderString }} · {{ .Site.Title | .RenderString }}</title>
  <link rel="canonical" href="{{ .Permalink }}">

  {{- $css := slice (resources.Get "css/reset.css") (resources.Get "css/theme.css") (resources.Get "css/_btn.css") (resources.Get "css/_select.css") (resources.Get "css/sidebar.css") (resources.Get "css/docs.css") (resources.Get "css/docs-article.css") (resources.Get "css/docs-chroma.css") (resources.Get "css/docs-shortcodes.css") (resources.Get "css/logo.css") (resources.Get "css/header.css") (resources.Get "css/footer.css") | resources.Concat "assets/css/docs.css" | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $css.RelPermalink }}" integrity="{{ $css.Data.integrity }}">

  {{- $js := slice (resources.Get "js/sidebar.js") (resources.Get "js/color-preference.js") (resources.Get "js/header.js") (resources.Get "js/off-canvas.js") (resources.Get "js/table-of-contents.js") | resources.Concat "assets/js/main.js" | minify | fingerprint }}
  <script src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.integrity }}" defer></script>

  {{ partial "favicons.html" . }}
  {{ partial "analytics.html" . }}
  {{ partial "og-x-seo.html" . }}
  {{ partial "structured-data.html" . }}
</head>

<body data-baseurl="{{ .Site.BaseURL }}">

{{ partial "header.html" . }}

<div id="outer-wrapper">

  {{ partial "sidebar.html" . }}

  <div id="content-wrapper">
   

    <main>
      <article>
        
        {{/* Breadcrumb Navigation */}}
        <nav class="breadcrumb" aria-label="Breadcrumb">
          <ol class="breadcrumb__list">
            <li class="breadcrumb__item">
              <a href="{{ .Site.Home.Permalink }}">Home</a>
            </li>
            {{ range .Ancestors.Reverse }}
            {{ if ne .Kind "home" }}
            <li class="breadcrumb__item">
              <span class="breadcrumb__separator">/</span>
              <a href="{{ .Permalink }}">{{ .Title }}</a>
            </li>
            {{ end }}
            {{ end }}
            <li class="breadcrumb__item breadcrumb__item--current">
              <span class="breadcrumb__separator">/</span>
              <span>{{ .Title }}</span>
            </li>
          </ol>
        </nav>

        {{/* Mobile TOC (shown on small screens) */}}
        <section class="mobile-toc" aria-label="On this page">
          <div class="mobile-toc__header">{{ i18n "onThisPage" }}</div>
          <div class="mobile-toc__body">
            {{ .TableOfContents }}
          </div>
        </section>
    
        <div id="article-body">
          {{ .Content | safeHTML }}
        </div>

        <footer class="article-footer">
          {{/* Use Hugo's built-in page navigation */}}
          {{ $pages := .CurrentSection.Pages.ByWeight }}
          {{ $currentIndex := 0 }}
          {{ range $index, $page := $pages }}
            {{ if eq $page.Permalink $.Permalink }}
              {{ $currentIndex = $index }}
            {{ end }}
          {{ end }}
          
          {{ $prevPage := index $pages (sub $currentIndex 1) }}
          {{ $nextPage := index $pages (add $currentIndex 1) }}

          <nav class="nav-buttons">
            {{ if and (gt $currentIndex 0) $prevPage }}
            <a href="{{ $prevPage.Permalink }}" class="nav-btn nav-btn--prev">
              <span class="nav-btn__label">{{ i18n "previous" }}</span>
              <span class="nav-btn__title">{{ $prevPage.Title }}</span>
            </a>
            {{ else }}
            <span class="nav-btn nav-btn--prev nav-btn--disabled"></span>
            {{ end }}

            {{ if $nextPage }}
            <a href="{{ $nextPage.Permalink }}" class="nav-btn nav-btn--next">
              <span class="nav-btn__label">{{ i18n "next" }}</span>
              <span class="nav-btn__title">{{ $nextPage.Title }}</span>
            </a>
            {{ else }}
            <span class="nav-btn nav-btn--next nav-btn--disabled"></span>
            {{ end }}
          </nav>
        </footer>
      </article>

      <aside>
        <div>
          <button class="btn"><i>❌</i>{{ i18n "close" }}</button>
        </div>
        <strong>{{ i18n "onThisPage" }}</strong>
        {{ .TableOfContents }}
      </aside>
    </main>

  </div>

</div>

{{ partial "footer.html" . }}

<div id="body-model-outer"></div>

{{- $js := slice (resources.Get "js/color-preference.js") (resources.Get "js/off-canvas.js") (resources.Get "js/table-of-contents.js") | resources.Concat "assets/js/docs.js" | minify | fingerprint }}
<script type="text/javascript" src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.integrity }}"></script>
</body>
</html>