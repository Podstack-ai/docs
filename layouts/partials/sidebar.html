<!--
  SIDEBAR PARTIAL (layouts/partials/sidebar.html)
  PURPOSE: Left navigation sidebar with recursive expandable section tree
  
  FEATURES:
  - Loads sidebar structure from data/en/docs/sidebar.yml
  - Recursive nesting support (unlimited levels)
  - Click section to navigate AND expand/collapse
  - Auto-expands active section path
  - Smooth expand/collapse animations
  - Mobile: Hidden by default, toggles with menu button
  - Desktop: Always visible, fixed left sidebar
  
  DATA SOURCE:
  - Reads from: data/en/docs/sidebar.yml
  - Passed to: layouts/partials/sidebar-item.html (recursive)
  
  ELEMENTS:
  - #aside-wrapper: Main sidebar container
  - .nav-root-item: Top-level section wrapper
  - .sidebar-nav: Navigation list
  - .sidebar-backdrop: Click overlay to close on mobile
  
  RELATED FILES:
  - partials/sidebar-item.html: Recursive section component
  - js/sidebar.js: Toggle and navigation logic
  - css/sidebar.css: Styling and animations
  - data/en/docs/sidebar.yml: Navigation structure
-->
<div id="aside-wrapper" class="sidebar-docker">
  <aside class="sidebar">
    <div class="sidebar-header">
      <span class="sidebar-header-title">Documentation</span>
      <button class="sidebar-close btn" aria-label="Close sidebar">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <nav class="sidebar-nav" role="navigation">
      {{ $data := index .Site.Data .Site.Language.Lang .Section "sidebar" }}
      {{/* Extract current path - handle both /docs/xxx and /docs/docs/xxx patterns */}}
      {{- $currentPath := .RelPermalink -}}
      {{- $currentPath = strings.TrimPrefix "/docs/docs/" $currentPath -}}
      {{- $currentPath = strings.TrimPrefix "/docs/" $currentPath -}}
      {{- $currentPath = strings.TrimPrefix "/" $currentPath -}}
      {{- $currentPath = strings.TrimSuffix "/" $currentPath -}}

      {{- range $item := $data -}}
        <div class="nav-root-item">
          {{- partial "sidebar-item.html" (dict "item" $item "currentPath" $currentPath "level" 0 "basePath" "") -}}
        </div>
      {{- end -}}
    </nav>
  </aside>
</div>
<div class="sidebar-backdrop"></div>
